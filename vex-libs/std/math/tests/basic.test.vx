// Math Module Tests
// Tests for mathematical functions

import { 
    sin_f64, cos_f64, tan_f64,
    sqrt_f64, pow_f64, abs_f64,
    PI, E,
    min_i32, max_i32, abs_i32,
    clamp_f64
} from "math";

fn test_trigonometry(): i32 {
    // Test sin
    let sin_result: f64 = sin_f64(0.0);
    if sin_result > 0.0001 || sin_result < -0.0001 {
        return 1; // sin(0) should be ~0
    }
    
    // Test cos
    let cos_result: f64 = cos_f64(0.0);
    if cos_result > 1.0001 || cos_result < 0.9999 {
        return 2; // cos(0) should be ~1
    }
    
    // Test PI/2
    let sin_pi2: f64 = sin_f64(PI / 2.0);
    if sin_pi2 > 1.0001 || sin_pi2 < 0.9999 {
        return 3; // sin(Ï€/2) should be ~1
    }
    
    return 0;
}

fn test_sqrt_and_pow(): i32 {
    // Test sqrt
    let sqrt4: f64 = sqrt_f64(4.0);
    if sqrt4 > 2.0001 || sqrt4 < 1.9999 {
        return 1; // sqrt(4) should be ~2
    }
    
    let sqrt9: f64 = sqrt_f64(9.0);
    if sqrt9 > 3.0001 || sqrt9 < 2.9999 {
        return 2; // sqrt(9) should be ~3
    }
    
    // Test pow
    let pow_result: f64 = pow_f64(2.0, 3.0);
    if pow_result > 8.0001 || pow_result < 7.9999 {
        return 3; // 2^3 should be ~8
    }
    
    return 0;
}

fn test_absolute_value(): i32 {
    // Test abs_i32
    if abs_i32(-5) != 5 {
        return 1; // abs(-5) should be 5
    }
    
    if abs_i32(7) != 7 {
        return 2; // abs(7) should be 7
    }
    
    if abs_i32(0) != 0 {
        return 3; // abs(0) should be 0
    }
    
    // Test abs_f64
    let abs_neg: f64 = abs_f64(-3.14);
    if abs_neg > 3.1401 || abs_neg < 3.1399 {
        return 4; // abs(-3.14) should be ~3.14
    }
    
    return 0;
}

fn test_min_max(): i32 {
    if min_i32(5, 10) != 5 {
        return 1; // min(5,10) should be 5
    }
    
    if max_i32(5, 10) != 10 {
        return 2; // max(5,10) should be 10
    }
    
    if min_i32(-5, -10) != -10 {
        return 3; // min(-5,-10) should be -10
    }
    
    return 0;
}

fn test_clamp(): i32 {
    let clamped1: f64 = clamp_f64(5.0, 0.0, 10.0);
    if clamped1 > 5.0001 || clamped1 < 4.9999 {
        return 1; // clamp(5, 0, 10) should be ~5
    }
    
    let clamped2: f64 = clamp_f64(-5.0, 0.0, 10.0);
    if clamped2 > 0.0001 || clamped2 < -0.0001 {
        return 2; // clamp(-5, 0, 10) should be ~0
    }
    
    let clamped3: f64 = clamp_f64(15.0, 0.0, 10.0);
    if clamped3 > 10.0001 || clamped3 < 9.9999 {
        return 3; // clamp(15, 0, 10) should be ~10
    }
    
    return 0;
}

fn test_constants(): i32 {
    // Test PI
    if PI > 3.1416 || PI < 3.1415 {
        return 1; // PI should be ~3.14159...
    }
    
    // Test E
    if E > 2.7183 || E < 2.7182 {
        return 2; // E should be ~2.71828...
    }
    
    return 0;
}

fn main(): i32 {
    println("Running math module tests...");
    
    // Test 1: Trigonometry
    let result1: i32 = test_trigonometry();
    if result1 != 0 {
        println("FAIL: test_trigonometry");
        return result1;
    }
    println("PASS: test_trigonometry");
    
    // Test 2: sqrt and pow
    let result2: i32 = test_sqrt_and_pow();
    if result2 != 0 {
        println("FAIL: test_sqrt_and_pow");
        return result2;
    }
    println("PASS: test_sqrt_and_pow");
    
    // Test 3: Absolute value
    let result3: i32 = test_absolute_value();
    if result3 != 0 {
        println("FAIL: test_absolute_value");
        return result3;
    }
    println("PASS: test_absolute_value");
    
    // Test 4: Min/Max
    let result4: i32 = test_min_max();
    if result4 != 0 {
        println("FAIL: test_min_max");
        return result4;
    }
    println("PASS: test_min_max");
    
    // Test 5: Clamp
    let result5: i32 = test_clamp();
    if result5 != 0 {
        println("FAIL: test_clamp");
        return result5;
    }
    println("PASS: test_clamp");
    
    // Test 6: Constants
    let result6: i32 = test_constants();
    if result6 != 0 {
        println("FAIL: test_constants");
        return result6;
    }
    println("PASS: test_constants");
    
    println("All math tests passed!");
    return 0;
}
