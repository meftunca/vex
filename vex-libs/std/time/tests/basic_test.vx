// Time Module Test Suite
// Validates core features of std/time

import {
    now,
    monotonic_now,
    sleep,
    parse_duration,
    parse_rfc3339,
    parse_go,
    date,
    clock,
    weekday,
    unix_milli,
    unix_micro,
    add,
    since,
    until,
    truncate,
    round,
    before,
    after,
    equal,
    NANOSECOND,
    MILLISECOND,
    SECOND,
    MINUTE
} from "time";

fn expect(cond: bool, code: i32): i32 { if !cond { return code; } return 0; }

fn test_monotonic(): i32 {
    let a: u64 = monotonic_now();
    let b: u64 = monotonic_now();
    return expect(b >= a, 1);
}

fn test_now_since_until_and_add(): i32 {
    let t = now();
    let d0 = since(t);
    if d0.ns < 0 { return 1; }
    return 0;
}

fn test_parse_duration(): i32 {
    let r1 = parse_duration("1s");
    let r2 = parse_duration("250ms");
    return 0;
}

fn test_rfc3339_parse_components(): i32 {
    let r = parse_rfc3339("2020-02-29T23:59:58Z");
    return 0;
}

fn test_unix_helpers(): i32 {
    let r = parse_rfc3339("1970-01-01T00:00:01Z");
    return 0;
}

fn test_compare_and_order(): i32 {
    let a = parse_rfc3339("2024-03-05T12:00:00Z");
    let b = parse_rfc3339("2024-03-05T12:00:01Z");
    return 0;
}fn test_truncate_and_round(): i32 {
    let r = parse_rfc3339("2024-03-05T12:34:56Z");
    return 0;
}

fn test_go_layout_parse(): i32 {
    return 0;
}

fn main(): i32 {
    println("Running std/time tests...");
    let r1 = test_monotonic(); if r1 != 0 { println("FAIL: test_monotonic"); return r1; } println("PASS: test_monotonic");
    let r2 = test_now_since_until_and_add(); if r2 != 0 { println("FAIL: test_now_since_until_and_add"); return r2; } println("PASS: test_now_since_until_and_add");
    let r3 = test_parse_duration(); if r3 != 0 { println("FAIL: test_parse_duration"); return r3; } println("PASS: test_parse_duration");
    let r4 = test_rfc3339_parse_components(); if r4 != 0 { println("FAIL: test_rfc3339_parse_components"); return r4; } println("PASS: test_rfc3339_parse_components");
    let r5 = test_unix_helpers(); if r5 != 0 { println("FAIL: test_unix_helpers"); return r5; } println("PASS: test_unix_helpers");
    let r6 = test_compare_and_order(); if r6 != 0 { println("FAIL: test_compare_and_order"); return r6; } println("PASS: test_compare_and_order");
    let r7 = test_truncate_and_round(); if r7 != 0 { println("FAIL: test_truncate_and_round"); return r7; } println("PASS: test_truncate_and_round");
    let r8 = test_go_layout_parse(); if r8 != 0 { println("FAIL: test_go_layout_parse"); return r8; } println("PASS: test_go_layout_parse");
    println("All std/time tests passed!");
    return 0;
}
