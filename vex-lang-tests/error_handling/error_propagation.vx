// Test file for Vex error handling: Error Propagation
// This file tests error propagation with ? operator

enum Result<T, E> {
    Ok(T),
    Err(E),
}

fn risky_operation(): Result<i32, string> {
    // Simulate some operation that might fail
    return Result.Ok(42);
}

fn another_risky_operation(x: i32): Result<i32, string> {
    if x < 0 {
        return Result.Err("Negative value");
    }
    return Result.Ok(x * 2);
}

fn process(): Result<i32, string> {
    let value = risky_operation()?;  // Propagate error if failed
    let doubled = another_risky_operation(value)?;  // Propagate error if failed
    return Result.Ok(doubled + 10);
}

fn main(): i32 {
    let result = process();

    let final_value = match result {
        Result.Ok(value) => { value }
        Result.Err(error) => { 0 }
    };

    // Test with error
    let error_result = another_risky_operation(-5);
    let error_handled = match error_result {
        Result.Ok(value) => { value }
        Result.Err(error) => { -1 }
    };

    return final_value + error_handled + 1;
}