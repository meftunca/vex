// Test: ? operator for Result early return
// Status: Parser ✅, Codegen ✅ (basic implementation)

fn divide(a: i32, b: i32): Result<i32, string> {
    if b == 0 {
        return Err("Division by zero");
    }
    return Ok(a / b);
}

fn safe_divide(a: i32, b: i32): Result<i32, string> {
    let result = divide(a, b)?;  // Early return if Err
    return Ok(result * 2);
}

fn nested_operations(): Result<i32, string> {
    let x = divide(10, 2)?;   // Ok(5)
    let y = divide(x, 0)?;    // Err - should propagate
    let z = divide(y, 2)?;    // Never reached
    return Ok(z);
}

fn main() {
    // Test basic ? operator
    let result1 = safe_divide(10, 2);
    match result1 {
        Ok(val) => { print(val); },      // Should print 10
        Err(msg) => { print(msg); }
    };
    
    // Test error propagation
    let result2 = safe_divide(10, 0);
    match result2 {
        Ok(val) => { print(val); },
        Err(msg) => { print(msg); }      // Should print "Division by zero"
    };
    
    // Test nested ?
    let result3 = nested_operations();
    match result3 {
        Ok(val) => { print(val); },
        Err(msg) => { print(msg); }      // Should print "Division by zero"
    };
}
