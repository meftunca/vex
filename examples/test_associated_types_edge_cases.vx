// Edge cases for associated types parsing (Self.Item syntax)

// Edge Case 1: Multiple associated types in one contract
contract KeyValue {
    type Key;
    type Value;
    
    get(key: Self.Key): Option<Self.Value>;
    set(key: Self.Key, value: Self.Value);
}

// Edge Case 2: Associated types in generic contexts
contract Container {
    type Item;
    
    get_all(): Vec<Self.Item>;
    get_first(): Option<Self.Item>;
    get_many(): Result<Vec<Self.Item>, i32>;
}

// Edge Case 3: Associated types with references
contract RefContainer {
    type Item;
    
    borrow_item(): Option<Self.Item>;
    get_slice(): Option<Self.Item>;
}

// Edge Case 4: Nested generics with associated types
contract Processor {
    type Input;
    type Output;
    type Error;
    
    process(input: Self.Input): Result<Self.Output, Self.Error>;
    batch_process(inputs: Vec<Self.Input>): Vec<Result<Self.Output, Self.Error>>;
}

// Edge Case 5: Implementation with concrete types
struct StringIntMap impl KeyValue {
    type Key = i32;
    type Value = i32;
    
    fn get(key: i32): Option<i32> {
        return Some(42);
    }
    
    fn set(key: i32, value: i32) {
        // noop
    }
}

// Edge Case 6: Associated type used in struct fields (should this work?)
struct Counter impl Container {
    type Item = i32;
    count: i32,
    
    fn get_all(): Vec<i32> {
        let! v = Vec.new();
        return v;
    }
    
    fn get_first(): Option<i32> {
        return Some(self.count);
    }
    
    fn get_many(): Result<Vec<i32>, i32> {
        let! v = Vec.new();
        return Ok(v);
    }
}

// Edge Case 7: Function type with associated types
contract Transformer {
    type Input;
    type Output;
    
    transform(): fn(Self.Input): Self.Output;
}

// Edge Case 8: Array of associated types
contract ArrayContainer {
    type Item;
    
    get_array(): Option<Self.Item>;
}

fn main(): i32 {
    // Test instantiation
    let! map = StringIntMap {};
    let result = map.get(5);
    
    return match result {
        Some(v) => v,
        None => -1,
    };
}
