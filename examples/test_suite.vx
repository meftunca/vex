// Example: Unit testing with std::testing
// Demonstrates the built-in test framework

import { testing } from "std";

// Test functions
fn test_addition(t: &mut testing.TestContext) {
    t.assert_eq(2 + 2, 4, "basic addition");
    t.assert_eq(10 + 5, 15, "larger numbers");
    t.assert_eq(-5 + 5, 0, "negative + positive");
}

fn test_multiplication(t: &mut testing.TestContext) {
    t.assert_eq(3 * 4, 12, "basic multiplication");
    t.assert_eq(7 * 0, 0, "multiply by zero");
    t.assert_eq(-3 * 2, -6, "negative multiplication");
}

fn test_division(t: &mut testing.TestContext) {
    t.assert_eq(10 / 2, 5, "basic division");
    t.assert_eq(15 / 3, 5, "exact division");
    t.assert_eq(7 / 2, 3, "integer division");
}

fn test_string_ops(t: &mut testing.TestContext) {
    let s = "Hello, World!";
    t.assert_eq(s.len(), 13, "string length");
    t.assert(s.starts_with("Hello"), "starts_with check");
    t.assert(s.ends_with("World!"), "ends_with check");
}

fn test_array_ops(t: &mut testing.TestContext) {
    let arr = [1, 2, 3, 4, 5];
    t.assert_eq(arr.len(), 5, "array length");
    t.assert_eq(arr[0], 1, "first element");
    t.assert_eq(arr[4], 5, "last element");
}

// This test should fail (for demonstration)
fn test_intentional_failure(t: &mut testing.TestContext) {
    t.assert_eq(2 + 2, 5, "this will fail");
}

fn main() :i32 {
    // Create test suite
    let mut suite = testing.new_suite("Math & String Tests");
    
    // Add tests
    suite.add_test("addition", test_addition);
    suite.add_test("multiplication", test_multiplication);
    suite.add_test("division", test_division);
    suite.add_test("string_ops", test_string_ops);
    suite.add_test("array_ops", test_array_ops);
    suite.add_test("intentional_failure", test_intentional_failure);
    
    // Run all tests
    let (passed, failed) = suite.run();
    
    // Return non-zero if any tests failed
    return if failed > 0 { 1 } else { 0 };
}
