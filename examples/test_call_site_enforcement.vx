// Comprehensive test: Call site mutability enforcement

struct Counter {
    value: i32,
    
    // Immutable method
    fn get(): i32 {
        return self.value;
    }
    
    // Mutable method
    fn increment()! {
        self.value = self.value + 1;
    }
    
    // Mutable method with params
    fn add(x: i32)!: i32 {
        self.value = self.value + x;
        return self.value;
    }
}

fn main(): i32 {
    let! counter = Counter { value: 0 };
    
    // ✅ Valid: Immutable method, no !
    let val1 = counter.get();
    print("Initial:", val1);
    
    // ✅ Valid: Mutable method, with !
    counter.increment()!;
    let val2 = counter.get();
    print("After increment:", val2);
    
    // ✅ Valid: Mutable method with params, with !
    let val3 = counter.add(5)!;
    print("After add(5):", val3);
    
    // ❌ Invalid: Would fail - mutable method without !
    // counter.increment();  // ERROR: requires !
    
    // ❌ Invalid: Would fail - immutable method with !
    // counter.get()!;  // ERROR: immutable method
    
    return 0;
}
