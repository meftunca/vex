// Test: Struct pattern matching (destructuring)
// Status: Parser âœ…, Codegen âœ… (already implemented)

struct Point {
    x: f32,
    y: f32
}

struct Vector2 {
    x: f32,
    y: f32
}

struct Color {
    r: u8,
    g: u8,
    b: u8,
    a: u8
}

fn test_basic_struct_pattern() {
    let p = Point { x: 10.0, y: 20.0 };
    
    match p {
        Point { x, y } => {
            print(x);  // 10.0
            print(y);  // 20.0
        }
    };
}

fn test_nested_struct_pattern() {
    struct Line {
        start: Point,
        end: Point
    }
    
    let line = Line {
        start: Point { x: 0.0, y: 0.0 },
        end: Point { x: 10.0, y: 10.0 }
    };
    
    match line {
        Line { start, end } => {
            match start {
                Point { x: x1, y: y1 } => {
                    match end {
                        Point { x: x2, y: y2 } => {
                            print(x1);  // 0.0
                            print(y2);  // 10.0
                        }
                    };
                }
            };
        }
    };
}

fn test_partial_struct_pattern() {
    let c = Color { r: 255, g: 128, b: 64, a: 255 };
    
    match c {
        Color { r, g, b, a } => {  // Match all fields explicitly
            print(r);
            print(g);
        }
    };
}

fn distance(p: Point): f32 {
    match p {
        Point { x, y } => {
            return (x * x + y * y);  // Simplified distance
        }
    };
}

fn origin_check(p: Point): bool {
    match p {
        Point { x, y } => {  // Match all fields
            if x == 0.0 && y == 0.0 {
                return true;
            } else {
                return false;
            };
        }
    };
}

fn quadrant(p: Point): i32 {
    match p {
        Point { x, y } => {
            if x > 0.0 && y > 0.0 {
                return 1;
            } else if x < 0.0 && y > 0.0 {
                return 2;
            } else if x < 0.0 && y < 0.0 {
                return 3;
            } else if x > 0.0 && y < 0.0 {
                return 4;
            } else {
                return 0;  // On axis
            };
        }
    };
}

fn main() {
    test_basic_struct_pattern();
    test_nested_struct_pattern();
    
    let p1 = Point { x: 3.0, y: 4.0 };
    let dist = distance(p1);
    print(dist);  // 25.0
    
    let origin = Point { x: 0.0, y: 0.0 };
    let is_origin = origin_check(origin);
    if is_origin {
        print(1);
    } else {
        print(0);
    };
    
    let p2 = Point { x: -5.0, y: 3.0 };
    let q = quadrant(p2);
    print(q);  // 2
}
